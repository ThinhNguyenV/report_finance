# Marketing Data Analysis & ETL Pipeline - Q3/2020

This project provides an end-to-end solution for processing, standardizing, and analyzing Marketing, Sales, and Shipping data for the third quarter of 2020. It transforms inconsistent raw data into a structured format and visualizes it through an advanced Power BI dashboard for executive decision-making.

---

## ğŸ›  Tech Stack
* **Data Processing:** Python (Pandas, NumPy, Regex)
* **Machine Learning:** Scikit-Learn (Random Forest Regressor)
* **Visualization:** Power BI Desktop
* **Advanced Visuals:** Zebra BI, Inforiver Charts, PowerKPI, Performance Bubble Chart
* **Data Source:** Multi-sheet Excel database (`MKT`, `Sales`, `Váº­n Ä‘Æ¡n`)

---

## ğŸ“‹ Data Processing Pipeline

The raw database (Q3/2020) contained significant formatting and consistency issues that required technical intervention before analysis.

### 1. Key Data Issues & Technical Solutions
| ID | Issue | Cause & Impact | Technical Fix |
| :--- | :--- | :--- | :--- |
| **1** | **Sales Data Loss** | Null values in "Call Date" caused data loss during Q3 filtering. | Switched filtering logic to `lead_date` to retain 100% of generated leads. |
| **2** | **Year Error** | "Close Date" contained 2023 entries instead of 2020. | Implemented `fix_year_logic` to automatically map dates back to the reporting period. |
| **3** | **Naming/Encoding** | Column names contained Vietnamese accents and special characters. | Used **Regex** to strip accents and standardize names for query compatibility. |
| **4** | **Data Typing** | Currency and quantity columns contained non-numeric text strings. | Applied **Type Casting** with error handling, defaulting gaps to 0. |
| **5** | **Order Status** | Success metrics were scattered across "Status" and "Level" columns. | Created an `is_successful` flag for entries marked "dat hang" or "Level 8". |

---

## ğŸ“Š Power BI Dashboard Structure

The `Q3.pbix` file contains a multi-page interactive report designed to track the entire customer journey from lead generation to shipping.

### 1. Marketing Performance (MKT)
* **Revenue Trend Development:** Time-series analysis of marketing spend vs. income.
* **Conversion Funnel Analysis:** Visualization of the journey from Impression to Lead to Order.
* **Campaign Optimization Matrix:** Scatter analysis to identify high-ROAS vs. high-cost campaigns.
* **Marketer Efficiency:** Comparison of cost-per-lead and revenue generated by individual team members.

### 2. Sales Intelligence (SALES)
* **Sales Pipeline Funnel:** Detailed view of lead progression through different levels.
* **Sales Representative Leaderboard:** Performance ranking based on conversion rates and revenue.
* **Geographic Distribution:** Lead segmentation by province and top cities using interactive maps.

### 3. Logistics & Shipping (Váº¬N ÄÆ N)
* **Shipment Volume Trends:** Daily monitoring of outgoing packages and delivery status.
* **Carrier Performance:** Correlation analysis between shipping costs, weight, and delivery partners.
* **Regional Logistics:** Analysis of shipment distribution across different geographic regions.

---

## ğŸ¤– Predictive Modeling & Analysis
This project implements a Machine Learning pipeline to transition from descriptive reporting to predictive strategy.
* **Financial Forecasting (Random Forest):** An ensemble regressor chosen for its robustness against outliers and ability to capture non-linear trends.
* **Recursive Logic:** Generates a **30-day outlook** by utilizing a recursive strategy where the prediction for day $t$ is fed back as an input for day $t+1$.
* **Feature Engineering:**
    * **Lag Features:** Captures momentum using historical Revenue and Lead counts.
    * **Temporal Features:** Accounts for cyclic business behavior (Day-of-Week, Month-end).
* **Model Persistence:** Serialized via **Pickle** (`.pkl`) for instant deployment and inference.
* **Driver Analysis:**
    * **Feature Importance:** Ranks top variables (Campaigns, Regions) contributing to success.
    * **Lead Scoring:** Correlates sources (FB, Google, etc.) with the `is_successful` flag.

---

## ğŸš€ Strategic Roadmap for Q4/2020

* **Technical Audit:** Re-configure GTM and Pixel tracking to ensure 100% visibility on Top-Funnel metrics.
* **Budget Optimization:** Shift spending toward high-ROAS channels (e.g., **Google/PerMax**).
* **Sales Training:** Address zero-conversion issues in "FB/Mess" leads through targeted sales process refinement.
* **CPA Control:** Implement hard budget caps on campaigns exceeding target cost-per-acquisition thresholds.

---

## ğŸ“‚ Project Structure
```text
report_finance/
â”œâ”€â”€ data/                               # Core datasets
â”‚   â”œâ”€â”€ daily_finance_summary.csv
â”‚   â”œâ”€â”€ Database-Q3_2020.xlsx
â”‚   â”œâ”€â”€ finance_forecast_next_month.csv
â”‚   â””â”€â”€ preprocessed_finance_data.csv
â”œâ”€â”€ data_pbi/                           # Processed data for Power BI
â”‚   â”œâ”€â”€ Processed_MKT_Q3.csv
â”‚   â”œâ”€â”€ Processed_Sales_Q3.csv
â”‚   â””â”€â”€ Processed_VanDon_Q3.csv
â”œâ”€â”€ data_pbi/                           # Processed data model
â”‚   â”œâ”€â”€ daily_finance_summary.csv
â”‚   â”œâ”€â”€ finance_forecast_next_month.csv
â”‚   â””â”€â”€ preprocessed_finance_data.csv
â”œâ”€â”€ model/                              # Python logic & ML assets
â”‚   â”œâ”€â”€ analyze/                        # Sub-analysis modules
â”‚   â”œâ”€â”€ analyze_data.py                 # Exploratory Data Analysis (EDA)
â”‚   â”œâ”€â”€ finance_forecast_model.pkl      # Saved Random Forest model
â”‚   â”œâ”€â”€ forecast_next_month.py          # Recursive forecasting script
â”‚   â”œâ”€â”€ plot_forecast.py                # Visualization script
â”‚   â”œâ”€â”€ preprocess_data.py              # Feature engineering & cleaning
â”‚   â””â”€â”€ train_model.py                  # Model training & evaluation
â”œâ”€â”€ predict/                            # Exported charts & images
â”‚   â”œâ”€â”€ finance_forecast_combined_trend.png
â”‚   â””â”€â”€ finance_trend.png
â”œâ”€â”€ BÃ¡o CÃ¡o PhÃ¢n TÃ­ch CÃ¡c Yáº¿u Tá»‘ Phi Thá»i Gian.md
â”œâ”€â”€ BÃ¡o CÃ¡o PhÃ¢n TÃ­ch vÃ  Dá»± BÃ¡o TÃ i ChÃ­nh.md
â”œâ”€â”€ process_data.ipynb                  # Jupyter Notebook for experimentation
â”œâ”€â”€ Q3.pbix                             # Power BI Dashboard
â””â”€â”€ README.md